<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SDK 开发总结 | front-end</title>
    <meta name="description" content="a personal blog">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/front-end/assets/css/0.styles.59215ccd.css" as="style"><link rel="preload" href="/front-end/assets/js/app.a88e1da2.js" as="script"><link rel="preload" href="/front-end/assets/js/2.7828f7a4.js" as="script"><link rel="preload" href="/front-end/assets/js/13.289fbc8e.js" as="script"><link rel="prefetch" href="/front-end/assets/js/10.e35f737f.js"><link rel="prefetch" href="/front-end/assets/js/11.c4818444.js"><link rel="prefetch" href="/front-end/assets/js/12.adefcf89.js"><link rel="prefetch" href="/front-end/assets/js/14.5b7a90db.js"><link rel="prefetch" href="/front-end/assets/js/15.960745b5.js"><link rel="prefetch" href="/front-end/assets/js/16.d9f6ac9b.js"><link rel="prefetch" href="/front-end/assets/js/17.a922242a.js"><link rel="prefetch" href="/front-end/assets/js/18.e519fb2e.js"><link rel="prefetch" href="/front-end/assets/js/19.1ce9712b.js"><link rel="prefetch" href="/front-end/assets/js/20.e4fb1dc3.js"><link rel="prefetch" href="/front-end/assets/js/21.f160d686.js"><link rel="prefetch" href="/front-end/assets/js/22.5bbdb9a8.js"><link rel="prefetch" href="/front-end/assets/js/23.7816121a.js"><link rel="prefetch" href="/front-end/assets/js/24.9675e030.js"><link rel="prefetch" href="/front-end/assets/js/25.e7c3a1dc.js"><link rel="prefetch" href="/front-end/assets/js/26.9c61f899.js"><link rel="prefetch" href="/front-end/assets/js/27.959cc8fe.js"><link rel="prefetch" href="/front-end/assets/js/28.b5e23a0d.js"><link rel="prefetch" href="/front-end/assets/js/29.7b2c7d6f.js"><link rel="prefetch" href="/front-end/assets/js/3.03bc0eab.js"><link rel="prefetch" href="/front-end/assets/js/30.654517c9.js"><link rel="prefetch" href="/front-end/assets/js/31.408cc8f8.js"><link rel="prefetch" href="/front-end/assets/js/32.db5de3cc.js"><link rel="prefetch" href="/front-end/assets/js/33.72031c88.js"><link rel="prefetch" href="/front-end/assets/js/34.1eb8d601.js"><link rel="prefetch" href="/front-end/assets/js/35.a9e687c8.js"><link rel="prefetch" href="/front-end/assets/js/36.beddc298.js"><link rel="prefetch" href="/front-end/assets/js/37.4e100f8d.js"><link rel="prefetch" href="/front-end/assets/js/38.6eadbe92.js"><link rel="prefetch" href="/front-end/assets/js/39.38b7d565.js"><link rel="prefetch" href="/front-end/assets/js/4.7a69cc83.js"><link rel="prefetch" href="/front-end/assets/js/40.606e1d1b.js"><link rel="prefetch" href="/front-end/assets/js/41.b0bbf99f.js"><link rel="prefetch" href="/front-end/assets/js/42.45253c4f.js"><link rel="prefetch" href="/front-end/assets/js/43.8b24ef31.js"><link rel="prefetch" href="/front-end/assets/js/44.5bb8e60f.js"><link rel="prefetch" href="/front-end/assets/js/45.91df7ac4.js"><link rel="prefetch" href="/front-end/assets/js/46.8484468c.js"><link rel="prefetch" href="/front-end/assets/js/47.1776e82c.js"><link rel="prefetch" href="/front-end/assets/js/48.85fe29af.js"><link rel="prefetch" href="/front-end/assets/js/49.d65fdbfa.js"><link rel="prefetch" href="/front-end/assets/js/5.f2868031.js"><link rel="prefetch" href="/front-end/assets/js/50.8b8a1ffd.js"><link rel="prefetch" href="/front-end/assets/js/51.c8e2f737.js"><link rel="prefetch" href="/front-end/assets/js/52.db1a18eb.js"><link rel="prefetch" href="/front-end/assets/js/53.74a258ca.js"><link rel="prefetch" href="/front-end/assets/js/54.9cd7d75d.js"><link rel="prefetch" href="/front-end/assets/js/55.f1f6886c.js"><link rel="prefetch" href="/front-end/assets/js/56.c890af91.js"><link rel="prefetch" href="/front-end/assets/js/57.0c07b923.js"><link rel="prefetch" href="/front-end/assets/js/58.c5c82028.js"><link rel="prefetch" href="/front-end/assets/js/6.d7ef6033.js"><link rel="prefetch" href="/front-end/assets/js/7.1896c787.js"><link rel="prefetch" href="/front-end/assets/js/8.ae09b0b2.js"><link rel="prefetch" href="/front-end/assets/js/9.4c0a101a.js">
    <link rel="stylesheet" href="/front-end/assets/css/0.styles.59215ccd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end/" class="home-link router-link-active"><!----> <span class="site-name">front-end</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end/note/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/front-end/engineering/" class="nav-link router-link-active">
  工程化
</a></div> <a href="https://github.com/gyh9457/front-end/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end/note/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/front-end/engineering/" class="nav-link router-link-active">
  工程化
</a></div> <a href="https://github.com/gyh9457/front-end/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/engineering/think/specification.html" class="sidebar-link">工程规范自动化</a></li><li><a href="/front-end/engineering/think/如何开发一个ui组件库.html" class="sidebar-link">如何开发一个 ui 组件库</a></li><li><a href="/front-end/engineering/think/后台管理系统开发总结.html" class="sidebar-link">通用后台管理系统开发</a></li><li><a href="/front-end/engineering/think/工具库的设计与开发.html" class="active sidebar-link">SDK 开发总结</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>@grow-all/cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/engineering/grow-all-cli/" class="sidebar-link">介绍</a></li><li><a href="/front-end/engineering/grow-all-cli/create.html" class="sidebar-link">创建项目的流程</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="sdk-开发总结"><a href="#sdk-开发总结" class="header-anchor">#</a> SDK 开发总结</h3> <p><code>sdk</code> 通常是封装业务中常用的能力，方便在业务开发中快速使用，比如说登录、权限管理、请求等。</p> <p><code>sdk</code> 的开发，包含以下几个方面：</p> <ul><li>需求分析</li> <li>功能开发</li> <li>单元测试</li> <li>构建发布</li> <li>文档编写</li> <li>技术支持</li></ul> <h3 id="需求分析"><a href="#需求分析" class="header-anchor">#</a> 需求分析</h3> <p>明确这个 sdk 要解决的问题是什么。边界在哪里。sdk 应该是职责明确的，而不是将功能都堆积在里面。</p> <h3 id="功能开发"><a href="#功能开发" class="header-anchor">#</a> 功能开发</h3> <p>在明确需求后，进行功能开发，需要注意的是，在 api 设计中，遵循开闭原则，保持良好的扩展性，使用户能够根据 sdk 提供的能力再扩展，最终满足不同业务的定制化需求。</p> <p>这个扩展性，可以通过插件机制来支撑。sdk 只能提供常规的能力，不应该做得大而全。对于一些特殊场景的特殊需求，应该由 sdk 提供基础能力，业务方利用基础能力再扩展、定制。</p> <p>功能开发过程中，还要明确兼容性，对于有兼容性要求而存在兼容性问题的，需要做特殊处理。常见的有 <code>IE9</code> 下的各种 api 不兼容问题，比如 <code>XMLHttpRequest</code> 不支持 <code>CORS</code>，需要使用 <code>XDomainRequest</code> 来做兼容。</p> <h3 id="单元测试"><a href="#单元测试" class="header-anchor">#</a> 单元测试</h3> <p>功能开发完成后，编写单元测试，对每个功能进行测试，单元测试应该覆盖大部分代码分支，使用场景，同时注意边界问题。</p> <h3 id="构建发布"><a href="#构建发布" class="header-anchor">#</a> 构建发布</h3> <p>构建之前进行完整的单元测试，单元测试不通过不允许构建。</p> <p>构建一般选用 <code>gulp</code> + <code>rollup</code>，配合 <code>babel</code> 或 <code>typescript</code> 。</p> <p>打包器选用 <code>rollup</code> 而不是 <code>webpack</code>。<code>webpack</code> 的优势在于打包不同类型的资源，包括 js、css、html 等，更适用于应用的打包。<code>rollup</code> 是一个 javascript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序。天然支持 <code>es6</code> 和 <code>tree-shaking</code>，更适用于 library 打包。而且 <code>webpack</code> 会生成运行时代码，增加包体积。</p> <p>一般 sdk 的构建产物有三个：<code>cjs</code>、<code>esm</code>、<code>umd</code>。对应不同的模块规范，</p> <p>在 <code>package.json</code> 中将 <code>main</code> 指向 <code>cjs</code> 所在目录；将 <code>module</code> 指向 <code>esm</code> 所在目录，配合 <code>webpack</code> 可以进行 <code>tree shaking</code> 优化；<code>umd</code> 文件用于供业务方直接以 url 的方式引入。</p> <h3 id="文档编写"><a href="#文档编写" class="header-anchor">#</a> 文档编写</h3> <p>良好的文档，对于 <code>sdk</code> 的开发者和使用者都能带来极高的收益。使用者可以用更小的学习成本使用，开发者可以减小不必要的客服时间。</p> <p>文档一般包含以下几个部分：</p> <ul><li>概述，简单介绍 sdk，一般包括这个 sdk 提供了什么能力？为什么要做这个 sdk。</li> <li>快速上手，sdk 的极简使用方式。</li> <li>API 文档，详细全面的 sdk api 说明。</li> <li>常见问题，记录使用中常见的问题，避免其他使用者重复踩坑。</li> <li>CHANGELOG，更新日志，便于使用者查阅遇到的问题新版本是否已经解决，或者是不是新版本的修改导致了现有代码上的 bug。</li></ul> <h3 id="技术支持"><a href="#技术支持" class="header-anchor">#</a> 技术支持</h3> <p>sdk 对外发布后，后续维护相当大一部分的精力主要花在对外答疑上。基本上使用者遇到的问题都是以下几类：</p> <ul><li>不知道是否有提供某个功能</li> <li>使用方式错误</li> <li>业务代码有问题，导致执行结果与预期不符，实际与 sdk 无关</li> <li>sdk 本身存在 bug</li></ul> <p>其中第一、第二、第四点，作为 sdk 的开发者，一般情况下能够比较容易地判断出来。对于第一、第二点，主要的应对措施是完善、细化文档。随着文档完善及使用熟练度上升，比较会逐渐下降。对于第四点，需要注意的是修改后发布的版本要遵循 <code>semver</code> 语义化版本规范。</p> <p>对于第三点，一般是提供一个简单的工程给业务方，要求业务方在上面将复杂的业务代码剥离后复现，如果复现不了，大概率问题原因不在 sdk，这时候可以要求业务方检查自己的代码。但有时候业务方检查后还是发现不了问题，又把问题甩了回来，这个时候只能拿他的工程项目看内部代码。</p> <p>大部分问题通过调试可以解决，比较极端的是业务方对 sdk 做了两次扩展，扩展 A 以比较常规的代码实现，扩展  B放在其他隐蔽的地方实现，比如以一个 cdn 上 js 文件的方式引入做扩展，重复操作导致出现 bug。</p> <h3 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h3> <p><a href="https://github.com/grow-all/sdk" target="_blank" rel="noopener noreferrer">sdk 一个简单可用的 sdk 模板<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/29/2020, 9:01:02 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end/engineering/think/后台管理系统开发总结.html" class="prev">
        通用后台管理系统开发
      </a></span> <span class="next"><a href="/front-end/engineering/grow-all-cli/">
        介绍
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/front-end/assets/js/app.a88e1da2.js" defer></script><script src="/front-end/assets/js/2.7828f7a4.js" defer></script><script src="/front-end/assets/js/13.289fbc8e.js" defer></script>
  </body>
</html>
