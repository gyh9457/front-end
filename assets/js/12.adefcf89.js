(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{212:function(e,t,_){"use strict";_.r(t);var v=_(0),r=Object(v.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h3",{attrs:{id:"如何开发一个-ui-组件库"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#如何开发一个-ui-组件库"}},[e._v("#")]),e._v(" 如何开发一个 ui 组件库")]),e._v(" "),_("h3",{attrs:{id:"规范制定"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#规范制定"}},[e._v("#")]),e._v(" 规范制定")]),e._v(" "),_("p",[e._v("一个复杂的 ui 组件库需要多人协作开发，良好的规范使代码更加简洁、易读、健壮，也有利于后期的不断迭代、维护。")]),e._v(" "),_("p",[e._v("规范包含以下几个方面：")]),e._v(" "),_("ul",[_("li",[e._v("eslint")]),e._v(" "),_("li",[e._v("stylelint")]),e._v(" "),_("li",[e._v("prettier")]),e._v(" "),_("li",[e._v("git commit 规范")])]),e._v(" "),_("p",[e._v("以上这些通过 "),_("code",[e._v("eslint")]),e._v(" "),_("code",[e._v("stylelint")]),e._v(" "),_("code",[e._v("perttier")]),e._v(" "),_("code",[e._v("husky")]),e._v(" "),_("code",[e._v("commitizen")]),e._v(" "),_("code",[e._v("commitlint")]),e._v(" 等工具相结合，形成一套完整的校验流程。")]),e._v(" "),_("h3",{attrs:{id:"文档系统"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文档系统"}},[e._v("#")]),e._v(" 文档系统")]),e._v(" "),_("p",[e._v("ui 组件库需要一个展示 quick start、api、demo、changelog、faq 等内容的站点，方便用户快速接入。一份好的文档可以节约组件开发者和组件使用者的大量时间和精力。")]),e._v(" "),_("p",[e._v("文档系统可以参考以下这些：")]),e._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://github.com/benjycui/bisheng",target:"_blank",rel:"noopener noreferrer"}},[e._v("bisheng"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://www.npmjs.com/package/docx",target:"_blank",rel:"noopener noreferrer"}},[e._v("docz"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://github.com/storybookjs/storybook",target:"_blank",rel:"noopener noreferrer"}},[e._v("storybook"),_("OutboundLink")],1)])]),e._v(" "),_("h3",{attrs:{id:"构建发布"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#构建发布"}},[e._v("#")]),e._v(" 构建发布")]),e._v(" "),_("p",[e._v("一般需要提供 "),_("code",[e._v("esm")]),e._v(" "),_("code",[e._v("cjs")]),e._v(" "),_("code",[e._v("umd")]),e._v(" 三种格式，同时将 "),_("code",[e._v("less")]),e._v("、"),_("code",[e._v("sass")]),e._v(" 等 css 预处理器写的样式编译为 "),_("code",[e._v("css")]),e._v("。")]),e._v(" "),_("p",[e._v("通常还需要提供 "),_("a",{attrs:{href:"https://ant.design/docs/react/getting-started-cn#%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD",target:"_blank",rel:"noopener noreferrer"}},[e._v("按需加载"),_("OutboundLink")],1),e._v(" 能力，组件库包含的组件很多，而业务可能只需要用到其中的一小部分。")]),e._v(" "),_("p",[e._v("构建工具参考：")]),e._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://github.com/ant-design/antd-tools",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd-tools"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://github.com/umijs/father",target:"_blank",rel:"noopener noreferrer"}},[e._v("father"),_("OutboundLink")],1)])]),e._v(" "),_("h3",{attrs:{id:"组件开发"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#组件开发"}},[e._v("#")]),e._v(" 组件开发")]),e._v(" "),_("p",[e._v("组件库的核心便是一个个组件，那么每个组件的开发一般遵循什么样的流程呢？")]),e._v(" "),_("h4",{attrs:{id:"明确兼容性"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#明确兼容性"}},[e._v("#")]),e._v(" 明确兼容性")]),e._v(" "),_("p",[e._v("明确兼容到什么版本的浏览器，比如说 "),_("code",[e._v("IE9+")]),e._v("、"),_("code",[e._v("IE11+")]),e._v("、"),_("code",[e._v("Android4.0+")]),e._v(" 等。")]),e._v(" "),_("p",[e._v("根据公司业务需要判断需要兼容到什么程度。尽量推动用户使用更高版本的浏览器，对低版本浏览器做降级处理需要消耗大量的精力，性价比很低。")]),e._v(" "),_("p",[e._v("之前使用过的 css 兼容方案：\n通过特定属性来判断该浏览器是否是 "),_("code",[e._v("IE9")]),e._v("，比如：")]),e._v(" "),_("div",{staticClass:"language-js extra-class"},[_("pre",{pre:!0,attrs:{class:"language-js"}},[_("code",[e._v("  "),_("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[e._v("isIe9")]),e._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),_("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v("window"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("atob\n  "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),_("p",[e._v("使用 css hack 的方式，比如：")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("\\9")]),e._v(" IE6/IE7/IE8/IE9/IE10都生效")]),e._v(" "),_("li",[_("code",[e._v("\\0")]),e._v(" IE8/IE9/IE10都生效，是IE8/9/10的hack")]),e._v(" "),_("li",[_("code",[e._v("\\9\\0")]),e._v(" 只对IE9/IE10生效，是IE9/10的hack")]),e._v(" "),_("li",[_("code",[e._v("@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)")]),e._v(" 对 "),_("code",[e._v("IE10+")]),e._v(" 有效。")])]),e._v(" "),_("p",[e._v("之前解决的一些兼容性问题：")]),e._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://github.com/ant-design/ant-design/pull/14068",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fix popover style with box-shadow"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://github.com/react-component/tabs/pull/159",target:"_blank",rel:"noopener noreferrer"}},[e._v("fix ie9 is not support translate3d"),_("OutboundLink")],1)]),e._v(" "),_("li",[_("a",{attrs:{href:"https://github.com/react-component/collapse/pull/110",target:"_blank",rel:"noopener noreferrer"}},[e._v("fix inherited bug"),_("OutboundLink")],1)])]),e._v(" "),_("h4",{attrs:{id:"需求分析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#需求分析"}},[e._v("#")]),e._v(" 需求分析")]),e._v(" "),_("p",[e._v("每个组件需要提供什么样的功能，一般来源于以下几个方面：")]),e._v(" "),_("ul",[_("li",[e._v("设计师提交的需求，这个应该是主要来源，专业的交互设计才能带来良好的体验")]),e._v(" "),_("li",[e._v("总结业务中常用的场景")]),e._v(" "),_("li",[e._v("参照竞品")])]),e._v(" "),_("p",[e._v("通过这些总结出原始需求，然后再结合合理性判断(比如有时候设计提的需求不合理) 提炼出最终要实现的功能。")]),e._v(" "),_("h4",{attrs:{id:"组件设计与抽象"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#组件设计与抽象"}},[e._v("#")]),e._v(" 组件设计与抽象")]),e._v(" "),_("p",[e._v("根据组件需要的能力设计对应的api及实现方式。")]),e._v(" "),_("p",[e._v("api的设计遵循简约、合理、易用的原则。对于相同或相似的能力，保持名称的一致性，比如 "),_("code",[e._v("visible")]),e._v(" "),_("code",[e._v("onChange")]),e._v(" 这些比较通用的 api 名称。")]),e._v(" "),_("p",[e._v("实现上要思考是否进行分层。")]),e._v(" "),_("p",[e._v("交互较为简单或纯做内容展示的组件，可以不做分层处理，直接在组件库中实现。比如说 "),_("code",[e._v("Button")]),e._v(" "),_("code",[e._v("Badge")]),e._v(" 组件，只有简单的交互，主要侧重于 ui 展示。")]),e._v(" "),_("p",[e._v("有一定交互复杂度的组件建议分为 "),_("code",[e._v("基础能力层")]),e._v(" 和 "),_("code",[e._v("ui表现层")]),e._v(" 两部分。其中，基础能力层满足基础的交互能力，ui表现层 保持 ui设计的一致性、稳定性。分层设计遵循单一职责原则，同时提高了代码的复用性。基础能力层下沉，作为一个单一组件实现，以单独的 "),_("code",[e._v("npm包")]),e._v(" 发布。ui 表现层则在当前组件库上实现。")]),e._v(" "),_("p",[e._v("比如说 "),_("code",[e._v("antd")]),e._v(" 的 "),_("code",[e._v("Message")]),e._v(" 和 "),_("code",[e._v("Notification")]),e._v(" 组件。交互能力相似，ui 展示不同。底层都依赖于 "),_("code",[e._v("rc-notification")]),e._v("，上层 ui 则各自实现。")]),e._v(" "),_("p",[e._v("使用分层实现，如果是基础能力的 bug 或迭代，在组件库这一层面是不需要发布版本的(利用 npm version 自动升级)。一定程度上保证了 ui 库的稳定性。同时也更利于协作，让部分人可以更专注于某个组件的开发，而无须关心整个组件库。")]),e._v(" "),_("p",[e._v("分层实现，必然会出现很多的底层组件库，这些底层组件库的代码组织方式、构建、文档等也要遵循一定的规范，便于后续迭代。这一部分可以参考 "),_("a",{attrs:{href:"https://github.com/react-component",target:"_blank",rel:"noopener noreferrer"}},[e._v("react-component"),_("OutboundLink")],1),e._v("。")]),e._v(" "),_("h4",{attrs:{id:"编码实现"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#编码实现"}},[e._v("#")]),e._v(" 编码实现")]),e._v(" "),_("p",[e._v("组件库的开发语言，建议选用 ts，虽然会带来一定的学习和使用成本，但做好类型声明，可以显著提高程序的健壮性，配合 IDE 也可以实现属性自动提示，提高开发效率。")]),e._v(" "),_("p",[e._v("根据不同的类别，对组件进行归类，可以参考市面上流行组件库的分类，比如 "),_("code",[e._v("antd")]),e._v(" 分为 "),_("code",[e._v("通用组件")]),e._v("、"),_("code",[e._v("布局组件")]),e._v("、"),_("code",[e._v("导航组件")]),e._v(" 等。")]),e._v(" "),_("p",[e._v("样式管理有 "),_("code",[e._v("css-in-js")]),e._v("、"),_("code",[e._v("css-module")]),e._v("、"),_("code",[e._v("css 预处理器")]),e._v(" 等方案。组件库建议使用 css 预处理器方案，可以增强 css 的可编程性，减少代码重复，让 css 更好维护，同时有利于开发者根据业务需要做样式覆盖。")]),e._v(" "),_("p",[e._v("一些全局通用属性，如 "),_("code",[e._v("locale")]),e._v("、"),_("code",[e._v("prefixCls")]),e._v(" 等，通过一个全局化配置组件来实现，每个组件内部做相应处理，参考 "),_("a",{attrs:{href:"https://ant.design/components/config-provider-cn/#header",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd ConfigProvider"),_("OutboundLink")],1),e._v("。")]),e._v(" "),_("h4",{attrs:{id:"测试"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[e._v("#")]),e._v(" 测试")]),e._v(" "),_("p",[e._v("测试可以分为单元测试和e2e测试两个部分")]),e._v(" "),_("h5",{attrs:{id:"单元测试"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#单元测试"}},[e._v("#")]),e._v(" 单元测试")]),e._v(" "),_("p",[e._v("使用 "),_("code",[e._v("jest")]),e._v(" "),_("code",[e._v("enzyme")]),e._v(" 等工具对每个组件的重要 api 和交互方式进行单元测试。")]),e._v(" "),_("h5",{attrs:{id:"e2e"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#e2e"}},[e._v("#")]),e._v(" e2e")]),e._v(" "),_("p",[e._v("推荐使用 "),_("a",{attrs:{href:"https://github.com/alibaba/f2etest",target:"_blank",rel:"noopener noreferrer"}},[e._v("f2etest"),_("OutboundLink")],1),e._v(" 进行 e2e 自动化测试，自动化模拟用户操作，确保 ui 交互符合预期。")]),e._v(" "),_("p",[e._v("内部使用 "),_("code",[e._v("uirecorder")]),e._v(" ，拥有自动化录制脚本能力，极大降低编写测试脚本的成本。")]),e._v(" "),_("h4",{attrs:{id:"通用能力"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#通用能力"}},[e._v("#")]),e._v(" 通用能力")]),e._v(" "),_("p",[e._v("需要对一些组件通用能力进行处理：")]),e._v(" "),_("ul",[_("li",[e._v("定制主题，参考 "),_("a",{attrs:{href:"https://ant.design/docs/react/customize-theme-cn",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd"),_("OutboundLink")],1)]),e._v(" "),_("li",[e._v("国际化")]),e._v(" "),_("li",[e._v("残障"),_("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/Accessibility/ARIA",target:"_blank",rel:"noopener noreferrer"}},[e._v("ARIA"),_("OutboundLink")],1),e._v("支持 (国外需要)")]),e._v(" "),_("li",[e._v("RTL 语言支持 参考 "),_("a",{attrs:{href:"https://ant.design/components/config-provider-cn/#components-config-provider-demo-direction",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd"),_("OutboundLink")],1)])]),e._v(" "),_("h4",{attrs:{id:"支持与维护"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#支持与维护"}},[e._v("#")]),e._v(" 支持与维护")]),e._v(" "),_("p",[e._v("在组件库使用的过程中，难免会出现使用疑问或者bug需要修复。这个时候就需要一个支持、维护的流程。")]),e._v(" "),_("p",[e._v("首先需要提供提供一份清晰的版本履历，让用户知道修改了哪些内容。有可能用户遇到的问题在之前的版本中已经修复了，只需要升级版本即可。")]),e._v(" "),_("p",[e._v("通过 "),_("code",[e._v("issue")]),e._v(" 或者其他公司内部的沟通方式来接受反馈。")]),e._v(" "),_("p",[e._v("提供一个简单的 demo 工程，可以是一个仓库或者是一个 codepen 地址，便于使用者复现问题。很多情况下，使用者的问题往往是由于使用不当导致的，在复现的过程中就可以自己找到解决方案。")]),e._v(" "),_("p",[e._v("以 pr 的形式进行迭代，每个 pr 写清楚修复的问题或者新增的特性等，便于后期遇到问题时查阅。")])])}),[],!1,null,null,null);t.default=r.exports}}]);